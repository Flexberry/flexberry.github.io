---
title: Мастера и детейлы
sidebar: product--sidebar
keywords: Flexberry ASP-NET, Windows UI (Контролы), Windows UI (формы)
toc: true
permalink: ru/masters-and-details.html
folder: product--folder
lang: ru
---


В данной статье приведёны замечания по работе с [мастеровыми ассоциациями](master--association.html) и [детейловыми композициями](detail-associations-and-their-properties.html)(определение этих понятий см. [здесь](key-concepts-flexberry-designer.html)).

# Рекомендации по рисованию диаграммы классов
Существуют рекомендации по рисованию диаграммы классов:
* Направление связи
** [Мастеровыми ассоциации](master--association.html) рисуются "вбок".
** [Детейловые композиции](detail-associations-and-their-properties.html) рисуются "вниз".
** [Наследование](inheritance.html) рисуется "вверх".
* Именование связи
** Имя [мастера](key-concepts-flexberry-designer.html) обычно совпадает с именем класса.
** Имя [детейла](key-concepts-flexberry-designer.html) (имя, которое будет носить коллекция в объектной модели)обычно во множественном числе.
** Связи типа ассоциации необходимо именовать со стороны мастера, типа композиции - с обоих сторон.
* Параметры связи
** Классы, объединенные связью со множественностью "1:1", объединяются в один класс.
** Связи типа "Агрегация" заменяются либо на Ассоциацию, либо на Композицию.

(((
<msg type=note>"Входящие" в класс концы связей могут иметь одинаковые имена, поскольку по этим именам объекты других классов будут обращаться к этому объекту.

![](/images/pages/img/page/MastersAndDetails/SameLinkNames.png)

Соответственно, "исходящие" из класса концы связей должны иметь разные имена, поскольку эти имена будут носить поля класса, а одинаковые имена для полей не допустимы.
</msg>
)))
(((
<msg type=note>Детейл может выступать в роли мастера, но это потребует некоторых дополнительных усилий.


![](/images/pages/img/Flexberry plugins/ConnectDetailsMaster.PNG)


О том, как это сделать, рассказывается в [этой статье](detail-as-master.html).
</msg>
)))



# Отображение на интерфейсе формы
Что именно появится на интерфейсе формы после генерации диаграммы классов, содержащей [мастеровые ассоциации](master--association.html) и [детейловые композиции](detail-associations-and-their-properties.html), рассмотрим на примере:


![](/images/pages/img/page/MastersAndDetails/ClassDiagram_MastersAndDetails.jpg)
После генерации '''Windows-форма''' будет выглядеть примерно вот так:


![](/images/pages/img/page/MastersAndDetails/FormInterface.jpg)
А '''web-форма''' так:


![](/images/pages/img/page/MastersAndDetails/WebFormInterface.jpg)



Как можно заметить, [мастеровые ассоциации](master--association.html) определили лукапы (как настроить внешний вид лукапа, описано [здесь](generate-lookup--i-lookup.html)), а [детейловая композиция](detail-associations-and-their-properties.html) - [GroupEdit](group-edit.html).

# Обновление детейлов
При попытке обновить детейлы, иногда возникает необходимость обновить какое-то поле агрегатора.

Логика прописана в методе `OnUpdate` детейла. В аггрегатор вносятся необходимые изменения и он отправляется на обновление вместе с детейлом, попав в `return` метода `OnUpdate`

К примеру, взяв диаграмму классов, описанную выше, попробуем обновить `Кредит` при обновлении `СтрокиПланаПогашения`:
```
public virtual ICSSoft.STORMNET.DataObject[] OnUpdateСтрокаПланаПогашения(IIS.Кредиты.СтрокаПланаПогашения UpdatedObject)
{
    var кредит = UpdatedObject.Кредит;
    кредит.СуммаКредита -= UpdatedObject.Сумма;
    return new DataObject[1](ис-управления-проектами_1.html) { кредит };
}```

Однако, такой способ __не сработает__.

'''Причина в том, что детейл обновляется вместе с агрегатором, а в таком случае aгрегатор обновляется вперед детейла, и после этого уже не обрабатывается'''.

В таком случае, необходимо вносить изменения в агрегатор в бизнес-сервере агрегатора.
----