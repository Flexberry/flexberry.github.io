---
title: Бизнес-серверы, обёртки, бизнес-фасад
sidebar: flexberry-orm_sidebar
keywords: Flexberry ORM, Public, Бизнес-серверы
toc: true
permalink: ru/fo_business--servers--wrapper--business--facade.html
---
## Бизнес-серверы, обёртки, бизнес-фасад
В сущности: бизнес-сервер есть набор методов. В `CASE` бизнес-сервер отрисовывается [UML-классом с установленным атрибутом «businessserver»](business-servers.html). Система может содержать произвольное число бизнес-серверов. В общем, число бизнес-серверов и состав их методов определяется прикладным разработчиком.


**Бизнес-сервер** — класс, непосредственно содержащий код бизнес-операций.

Заглушки, обёртки бизнес- сервера — позволяют исполнить бизнес-сервис в средах:

*	`COM+` (`COM+` обёртка) — позволяет пользоваться `COM+` с целью обеспечения транзакционности при множественных вызовах сервисов данных внутри одного метода, распределённых транзакции, «физической» реализации архитектуры с сервером приложений (исполнение бизнес-серверов на отдельной машине).
*	`IIS Hosted Remoting` (`IISHosted` обёртка) — позволяет обращаться к бизнес-серверу через `.NET Remoting`, посредством `HTTP`, в качестве транспорта используется `SOAP`. Использование такой обёртки позволяет работать в режиме, когда приложение с настольным пользовательским интерфейсом обращается к бизнес-серверу, расположенному где-либо, через `WEB`.

Бизнес-фасад предназначен для того, чтобы:

##	Нивелировать для программиста различия в обращении к бизнес-серверам через различные обёртки;
##	Обеспечить переключение работы приложения с бизнес-сервером через различные обёртки путём конфигурирования, а не изменения исходного кода.

Бизнес-фасад представляет собой класс с реализацией методов с теми же именами, что и в бизнес-сервере.
![](/images/pages/img/Учебник программиста Casseberry/primer9.jpg)
Таким образом, программист всегда может оперировать бизнес-операциями одинаковым образом (в независимости от того, через какую обёртку работает бизнес-сервер), вызывая их через бизнес-фасад. В зависимости от конфигурации приложения, указанной в настройках, бизнес-фасад маршрутизирует вызов напрямую к бизнес-серверу или к какой-либо обёртке.

## Порядок вызова бизнес-серверов
Следует учесть, что в бизнес-сервере может быть вызвано обновление объекта не через возвращаемый массив, а отдельным вызовом сервиса данных. В этом случае, надо учесть то, что бизнес-серверы будут вызываться для этого объекта отдельно.

### Наследование и бизнес-серверы
Если у нас имеется следующая ситуация:

![](/images/pages/img/page/Business-Servers-Wrapper-Business-Facade/BSHierarchy.JPG)

то бизнес-сервера при обновлении объекта класса Человек будут срабатывать в следующем порядке: 

## Существо
## Животное
## Млекопитающее
## Человек

Пример: [^{UP(Бизнес-серверы-обертки-бизнес-фасад)}BSHierarchiTesting.rar|BSHierarchiTesting.rar]


### Агрегатор, детейлы и бизнес-серверы
Если у нас имеется следующая ситуация:

![](/images/pages/img/page/Business-Servers-Wrapper-Business-Facade/AgregatorDetailAtBS.png)

то бизнес-сервера при обновлении будут срабатывать в следующем порядке:

## КлассАгрегатор
## КлассДетейл

## Правила обновления объекта данных
Например, у нас имеется следующая ситуация:

![](/images/pages/img/page/Business-Servers-Wrapper-Business-Facade/BusinesServerMasters.GIF)

Если в бизнес-сервере для класса Товар мы каким-то образом исправили Фирму-производителя и вернули её в методе бизнес-сервера, то для фирмы-производителя вызовется её бизнес-сервер. Важно понимать, что запрос для Товара был уже сгенерён (это было выполнено сразу после отработки его собственного бизнес-сервера) и в бизнес-сервере Фирмы-производителя изменять Товар не следует - новые изменения не будут зафиксированы в БД.


## Примеры
Примеры использования бизнес-серверов доступны в следующих статьях:

* [Отработка пользовательских операций в процессе работы сервиса данных (интеграция с бизнес-сервером)](otrabotka-polzovatelskih-operacii-v-processe-raboty-servisa-dannyh-integraciya-s-biznes-serverom.html)
* [Пример использования бизнес-сервера](b-s-example.html)
* [Проверка валидности изменений данных объекта в бизнес-сервере](b-s-change-data-check.html)
* [Особенности задания значения по умолчанию](features-of-dafault-value-assignment.html) (в данной статье также описано, как получить бизнес-сервер класса)

----
