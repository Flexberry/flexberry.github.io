---
title: Ярлыки рабочего стола
sidebar: flexberry-winforms_sidebar
keywords: Windows UI (формы)
summary: Подробно рассмотрен механизм применения ярлыков, предназначенный для работы с экземплярами объектов данных с рабочего стола, указано как его применять, примеры
toc: true
permalink: en/fw_win-desktop-links.html
folder: products/flexberry-winforms/
lang: en
---

Механизм ярлыков позволяет работать с экземплярами объектов данных с рабочего стола.
 
Ярлыки стоит применять, если с каким-либо экземпляром приходится работать очень часто. Это позволит не загружать списковую форму и не искать экземпляр на ней.

Ярлыки можно применять для экземпляра любого класса, который является наследником  ICSSoft.STORMNET.DataObject.

## Папки для ярлыков
Папки, в которых можно создавать ярлыки указываются с помощью переопределения метода GetShortCutFolders() класса DesktopCustomizer. Этот метод возвращает ArrayList, элементами которого являются строки, в которых указывается полный путь к папке. По умолчанию этот метод возвращает только папку «Избранное».  

Пример

```csharp
public class NewDesktopCustomizer : ICSSoft.STORMNET.UI.DesktopCustomizer
{
        …
        public override System.Collections.ArrayList GetShortCutFolders()
        {            
            System.Collections.ArrayList arr = base.GetShortCutFolders();
            arr.Add("NewFolder");
            return arr;
        }
        …
}
```

## Имя ярлыка
При создании ярлыка по умолчанию берется имя списковой формы. Для присвоения ярлыку адекватного имени нужно сделать следующее:
Класс соответствующего объекта необходимо пометить атрибутом ShortCutCaption. Параметром этого атрибута служит имя, с которым будет отображаться ярлык. В имени ярлыка можно указать @name@, где в качестве name выступает имя свойства или поля данного класса, тогда при определении имени ярлыка вместо данной конструкции будет подставлено значение указанного свойства или поля соответствующего объекта данных.

Пример:

```csharp
[ShortCutCaption("Кошка по кличке @Кличка@")]
public class Кошка : ICSSoft.STORMNET.DataObject
{
        …
        public virtual string Кличка
        {
            get
            {
                return this.fКличка;
            }
            set
            {
                this.fКличка = value;
            }
        }
        …
}
```

В результате имя ярлыка для объекта данных «Кошка» будет, например, таким: «Кошка по кличке Мурка».

## Раннеры
Раннер – класс, реализующий методы для запуска ярлыка. В конструкторе раннер принимает ярлык. Чтобы добавить новый раннер, нужно создать новый класс, наследующийся от DesktopShortCutRunner. Методы раннера, помеченные атрибутом RunnerMethodAttribute можно запустить из контекстного меню ярлыка, с данным типом раннера. Параметром атрибута является строка, которая будет отображаться в соответствующем пункте контекстного меню ярлыка.
В базовом классе DesktopShortCutRunner реализованы два стандартных метода:

	RunEditForm – запуск формы редактирования. Параметром передается название типа формы редактирования.

	RunObjectMethod – Запуск метода объекта. Параметром передается название метода.

Вторым параметром обоих методов может быть передано имя представления для загрузки объекта (этот параметр не обязателен, но в некоторых случаях его отсутствие может привести к ошибкам).
В раннере можно задать дефолтную картинку для ярлыков с данным типом.

## Как применить раннер для ярлыков

Раннер, которым будет запускаться ярлык, определяется автоматически при создании ярлыка.
Для того, чтобы раннер применялся для ярлыков объектов определенного типа, нужно сделать следующее:

1)	В раннере реализовать статический метод GetObjectTypes, возвращающий массив типов, для которых следует применять данных раннер.

2)	Переопределить метод GetShortCutRunners() класса DesktopCustomizer. Этот метод возвращает словарь, у которого ключ – это имя класса раннера, а значение – это массив поддерживаемых типов объектов, которые возвращает метод GetObjectTypes().

По умолчанию этот метод возвращает только раннер для отчетов (ReportRunner).

Пример:

```csharp
public class NewRunner : DesktopShortCutRunner
{
        …
        public static Type[] GetObjectsTypes()
        {
            return new Type[] { Type.GetType("ICSSoft.STORMNET.MyType, MyTypeAssemblyName") };
        }
        …
}

public class NewDesktopCustomizer : ICSSoft.STORMNET.UI.DesktopCustomizer
{
        …
        public override Dictionary<string, Type[]> GetShortCutRunners()
        {
            Dictionary<string, Type[]> shortCutRunners = base.GetShortCutRunners();
            shortCutRunners.Add("ICSSoft.STORMNET.NewShortCutRunner, NewShortCutRunnerAssemblyName", NewShortCutRunner.GetObjectsTypes());
            return shortCutRunners;
        }
        …
}
```

## Создание ярлыка из кода
Ярлык создается вызовом статического метода CreateShortCut. Метод принимает имя ярлыка, путь к папке, в которой отображать ярлык, тип раннера, объект данных, которому соответствует ярлык, тип формы редактирования и картинку, для отображения ярлыка. Если в качестве этого параметра передать null, то ярлык будет отображаться с дефолтной картинкой. Еще один необязательный параметр указывает является ли создаваемый ярлык общим или нет. Если ярлык общий, то в базе данных в поле User будет значение null и в дальнейшем его будут видеть все пользователи. Если же ярлык не является общим, то в базе данных ярлык сохранится с текущим пользователем.